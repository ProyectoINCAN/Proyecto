{%extends 'base/base2.html' %}
{% load static %}

{% block extrajs %}
<script src = "{% static 'apps/agendamientos/js/agenda.js' %}"></script>
{% endblock %}

{%block content %}

<div class="app-content-body">
    <div class="bg-light lter b-b wrapper-md">
        <h1 class="m-n font-thin h3">Detalles de agenda</h1>
    </div>

    <ol class="breadcrumb" style="background-color: #f6f8f8">
        <li><a href="#">Inicio</a></li>
        <li><a href="#">Agendamientos</a></li>
        <li><a href="#">Agenda</a></li>
        <li class="active">{{ agenda.id }}</li>
        <li class="active">Detalle</li>
    </ol>

    <div class="wrapper-md">
        <form method="POST" class="form-horizontal" id="form">
            <div class="row">
                {% include 'base/messages.html' %}
                <div class="col-lg-8 col-sm-12">
                {% csrf_token %}
                {{form.media}}
                    <div class="form-group">
                        <label class="control-label col-lg-2 col-sm-4">Fecha</label>
                        <div class="col-lg-3 col-sm-4">
                            <input type="text" class="form-control text-center" id="fecha" name ="fecha" value='{{agenda.fecha|date:"SHORT_DATE_FORMAT"}}' required="required"  disabled="disabled" data-inputmask="'alias': 'date'" placeholder="dd/mm/yyyy">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-lg-2 col-sm-4">Médico</label>
                        <div class="col-sm-6">
                            <input type="text" class="form-control text-left" id="medico" name ="medico" value="{{agenda.medico}}"  disabled="disabled">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-lg-2 col-sm-4">Turno</label>
                        <div class="col-lg-3 col-sm-4">
                            <input type="text" class="form-control text-left" id="turno" name ="turno" value="{{agenda.turno}}"  disabled="disabled">
                        </div>
                    </div>
                    <div class="form-group" align="center">
                        <a id="cancelar" type="button" class="btn btn-danger" > <i class="fa fa-ban" aria-hidden="true"></i> Cancelar Agenda</a>
                        <a href="{{origen_url}}" id="salir" class="btn btn-default"><i class="fa fa-arrow-left" aria-hidden="true"></i> Salir</a>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>

</div>
</form>




<br>
<div class="panel panel-default">
    <div class="panel-heading">
        <b>Lista de agendados</b>
        <div class="btn-group pull-right">
            <form id="consultas" method="post" action="{% url 'consultorios:consulta' agenda.id %}">
                {% csrf_token %}
                <a onclick="document.getElementById('consultas').submit();" class="btn btn-success btn-sm"><i class="fa fa-play" aria-hidden="true"></i> Pasar Agenda</a>
            </form>
        </div>
        <div class="btn-group pull-right">
            <a href="{% url 'agendamientos:agenda_detalle_paciente_list' agenda.id %}">
                <button class="btn btn-default"><i class="fa fa-plus-square"></i> Nuevo</button>
            </a>
        </div>
        <div class="clearfix"></div>
    </div>

    <div class="panel-body">
        <div id="dataTables-example_wrapper" class="dataTables_wrapper form-inline dt-bootstrap no-footer"><div class="row"><div class="col-sm-6"><div class="dataTables_length" id="dataTables-example_length"></div></div><div class="col-sm-6"><div id="dataTables-example_filter" class="dataTables_filter"></div></div></div><div class="row"><div class="col-sm-12"><table width="100%" class="table table-striped table-bordered table-hover dataTable no-footer dtr-inline" id="dataTables-example" role="grid" aria-describedby="dataTables-example_info" style="width: 100%;">
            <thead>
            <tr role="row">
                <td>Nº</td>
                <td>Ficha</td>
                <td>Nombre y Apellido</td>
                <td>Edad</td>
                <td>Ciudad</td>
                <td>Tel&eacute;fono</td>
                <td>Observación</td>
                <td>Confirmar</td>
            </tr>
            </thead>
            <tbody>
            {% if agenda_detalle %}
            {% for detalle in agenda_detalle %}
            <tr>
                <td>{{detalle.0}}</td>
                <td>{{detalle.1}}</td>
                <td>{{detalle.2}} {{detalle.3}}</td>
                <td>{{detalle.4}}</td>
                <td>{{detalle.5}}</td>
                <td>{{detalle.6}}: {{detalle.7}}</td>
                <td>{{detalle.8}}</td>
                <td>
                  {% if user.groups.all.0.name == "Administrativo_Ventanilla" or request.user.is_superuser %}
                   {% if detalle.11 %}
                     <h5>Confirmado</h5>
                   {% else %}
                    <a href="{% url 'agendamientos:agenda_detalle_confirmar' detalle.9 detalle.10 %}"
                    class="btn btn-danger">Confirmar</a>
                  {% endif %}
                  {% endif %}
                </td>
            </tr>
            {% endfor %}
            {% else %}
            {% endif %}
            </tbody>
        </table>
        </div>
        </div>
        </div>
    </div>
</div>

<div class="pagination">
    <ul class="pager">
        <li>
            {% if page_obj.has_previous %}
            <a href="?page={{ page_obj.previous_page_number}}">Anterior</a>
            {% endif%}
        </li>
        <li>
            {% if page_obj.has_next %}
            <a href="?page={{ page_obj.next_page_number}}">Siguiente</a>
            {% endif%}
        </li>
    </ul>
</div>
{% endblock%}
